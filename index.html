<!DOCTYPE html>
<html>

<head>
    <title>PDF to Excel Converter</title>
</head>

<body>
    <form id="uploadForm" method="post" enctype="multipart/form-data">
        <label for="pdfFile">Select PDF File:</label>
        <input type="file" name="pdfFile" id="pdfFile">
        <br>
        <input type="button" value="Upload" onclick="uploadFile()">
    </form>
    <br>
    <div id="uploadStatus"></div>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        function uploadFile() {
            var formData = new FormData(document.getElementById("uploadForm"));
            axios.post("http://localhost:3000/upload", formData, {
                responseType: 'blob'
            })
                .then(response => {
                    var blob = new Blob([response.data], { type: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" });
                    var link = document.createElement("a");
                    link.href = window.URL.createObjectURL(blob);
                    link.download = "converted.xlsx";
                    link.click();
                })
                .catch(error => {
                    document.getElementById("uploadStatus").innerHTML = "Upload failed";
                    console.log(error);
                });
        }
    </script>
</body>

</html>